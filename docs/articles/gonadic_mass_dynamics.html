<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Gonadic mass dynamics • mizerSeasonal</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Gonadic mass dynamics">
<!-- mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js">
</script><!--
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
--><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mizerSeasonal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/mizerSeasonal.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/gonadic_mass_dynamics.html">Gonadic mass dynamics</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gustavdelius/mizerSeasonal/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Gonadic mass dynamics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gustavdelius/mizerSeasonal/blob/HEAD/vignettes/gonadic_mass_dynamics.Rmd" class="external-link"><code>vignettes/gonadic_mass_dynamics.Rmd</code></a></small>
      <div class="d-none name"><code>gonadic_mass_dynamics.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="deriving-the-pde-for-gonadic-mass">Deriving the PDE for gonadic mass<a class="anchor" aria-label="anchor" href="#deriving-the-pde-for-gonadic-mass"></a>
</h2>
<p>Standard mizer describes the number density
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N(w,t)</annotation></semantics></math>
by the PDE
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>∂</mi><mi>N</mi></mrow><mrow><mi>∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>−</mi><mfrac><mi>∂</mi><mrow><mi>∂</mi><mi>w</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>g</mi><mspace width="0.167em"></mspace><mi>N</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>μ</mi><mspace width="0.167em"></mspace><mi>N</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\frac{\partial N}{\partial t} = -\frac{\partial}{\partial w}(g\,N)-\mu\,N,
\label{PDEN}
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(w,t)</annotation></semantics></math>
is the growth rate of an individual of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mu(w,t)</annotation></semantics></math>
is its death rate. This equation simply states that the rate of change
of the number of individuals in an infinitesimal size range around
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
is given by the difference between the rate at which individuals grow
into the size range and the rate at which they grow out (the transport
term), minus the rate at which they die (the loss term).</p>
<p>Instead of the number density
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
we could have used the biomass density
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mi>w</mi><mspace width="0.167em"></mspace><mi>N</mi></mrow><annotation encoding="application/x-tex">B = w\,N</annotation></semantics></math>
to describe the population. Its evolution equation can easily be derived
from :
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>∂</mi><mi>B</mi></mrow><mrow><mi>∂</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>w</mi><mfrac><mrow><mi>∂</mi><mi>N</mi></mrow><mrow><mi>∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>−</mi><mi>w</mi><mfrac><mi>∂</mi><mrow><mi>∂</mi><mi>w</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>g</mi><mspace width="0.167em"></mspace><mfrac><mi>B</mi><mi>w</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>μ</mi><mspace width="0.167em"></mspace><mi>B</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>−</mi><mfrac><mi>∂</mi><mrow><mi>∂</mi><mi>w</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>g</mi><mspace width="0.167em"></mspace><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>g</mi><mspace width="0.167em"></mspace><mfrac><mi>B</mi><mi>w</mi></mfrac><mo>−</mo><mi>μ</mi><mspace width="0.167em"></mspace><mi>B</mi><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}\begin{split}
\frac{\partial B}{\partial t} &amp;= w\frac{\partial N}{\partial t}
= -w\frac{\partial}{\partial w}\left(g\,\frac{B}{w}\right)-\mu\,B,\\
&amp;=-\frac{\partial}{\partial w}\left(g\,B\right)+g\,\frac{B}{w}-\mu\,B.
\end{split}\end{equation}</annotation></semantics></math> This is again
intuitive: in addition to the transport term and the loss term we now
also have a source term
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mi>B</mi><mi>/</mi><mi>w</mi><mo>=</mo><mi>g</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">g B/w = gN</annotation></semantics></math>
representing coming from the growth taking place within the
infinitesimal size class.</p>
<p>If we now denote by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q(w,t)</annotation></semantics></math>
the total gonadic biomass density and by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">G(w,t)</annotation></semantics></math>
the gonadic growth rate of an individual of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
(when it is not reproducing), then they satisfy the analogous equation
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>∂</mi><mi>Q</mi></mrow><mrow><mi>∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>−</mi><mfrac><mi>∂</mi><mrow><mi>∂</mi><mi>w</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>g</mi><mspace width="0.167em"></mspace><mi>Q</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>G</mi><mspace width="0.167em"></mspace><mi>N</mi><mo>−</mo><mi>μ</mi><mspace width="0.167em"></mspace><mi>Q</mi><mo>−</mo><mi>r</mi><mspace width="0.167em"></mspace><mi>Q</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\frac{\partial Q}{\partial t} 
=-\frac{\partial}{\partial w}\left(g\,Q\right)+G\,N-\mu\,Q-r\,Q,
\end{equation}</annotation></semantics></math> where we have an
additional loss term representing the release of gonadic mass during
reproduction. The release rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">r(w,t)</annotation></semantics></math>
will encode the seasonality of this reproduction.</p>
<p>In mizer, the total energy
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mi>r</mi></msub><annotation encoding="application/x-tex">E_r</annotation></semantics></math>
available for growth an reproduction is split as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>=</mo><msub><mi>E</mi><mi>r</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>ψ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g=E_r(1-\psi)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><msub><mi>E</mi><mi>r</mi></msub><mi>ψ</mi></mrow><annotation encoding="application/x-tex">G=E_r\psi</annotation></semantics></math>.
Thus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mi>g</mi><mspace width="0.167em"></mspace><mi>ψ</mi><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>ψ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">G=g\,\psi/(1-\psi)</annotation></semantics></math>.</p>
<p>Instead of considering the total gonadic biomass density
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q(w,t)</annotation></semantics></math>,
we could consider the gonadic mass
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">q(w,t)</annotation></semantics></math>
of an individual fish of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>,
given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mfrac><mi>Q</mi><mi>N</mi></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
q= \frac{Q}{N}.
\end{equation}</annotation></semantics></math> Let’s derive its
evolution PDE:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mrow><mi>∂</mi><mi>q</mi></mrow><mrow><mi>∂</mi><mi>t</mi></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mfrac><mrow><mi>∂</mi><mi>Q</mi></mrow><mrow><mi>∂</mi><mi>t</mi></mrow></mfrac><mo>−</mo><mfrac><mi>Q</mi><msup><mi>N</mi><mn>2</mn></msup></mfrac><mfrac><mrow><mi>∂</mi><mi>N</mi></mrow><mrow><mi>∂</mi><mi>t</mi></mrow></mfrac></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mfrac><mi>∂</mi><mrow><mi>∂</mi><mi>w</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>g</mi><mspace width="0.167em"></mspace><mi>Q</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>G</mi><mspace width="0.167em"></mspace><mi>N</mi><mo>−</mo><mi>μ</mi><mspace width="0.167em"></mspace><mi>Q</mi><mo>−</mo><mi>r</mi><mspace width="0.167em"></mspace><mi>Q</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mfrac><mi>Q</mi><msup><mi>N</mi><mn>2</mn></msup></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mfrac><mi>∂</mi><mrow><mi>∂</mi><mi>w</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>g</mi><mspace width="0.167em"></mspace><mi>N</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>μ</mi><mspace width="0.167em"></mspace><mi>N</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}\label{PDEwG}\begin{split}
\frac{\partial q}{\partial t} &amp;= \frac{1}{N}\frac{\partial Q}{\partial t}-
\frac{Q}{N^2}\frac{\partial N}{\partial t}\\
&amp;=\frac{1}{N}\left(-\frac{\partial}{\partial w}\left(g\,Q\right)+G\,N-\mu\,Q-r\,Q\right)
-\frac{Q}{N^2}\left(-\frac{\partial}{\partial w}(g\,N)-\mu\,N\right).
\end{split}\end{equation}</annotation></semantics></math> To simplify
this we observe that the two mortality terms cancel and that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mfrac><mi>Q</mi><msup><mi>N</mi><mn>2</mn></msup></mfrac><mfrac><mi>∂</mi><mrow><mi>∂</mi><mi>w</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>g</mi><mspace width="0.167em"></mspace><mi>N</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mi>q</mi><mi>N</mi></mfrac><mfrac><mi>∂</mi><mrow><mi>∂</mi><mi>w</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>g</mi><mspace width="0.167em"></mspace><mfrac><mi>Q</mi><mi>q</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><mfrac><mi>∂</mi><mrow><mi>∂</mi><mi>w</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>g</mi><mspace width="0.167em"></mspace><mi>Q</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>g</mi><mspace width="0.167em"></mspace><mfrac><mrow><mi>∂</mi><mi>q</mi></mrow><mrow><mi>∂</mi><mi>w</mi></mrow></mfrac><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}\begin{split}
\frac{Q}{N^2}\frac{\partial}{\partial w}(g\,N)
&amp;=\frac{q}{N}\frac{\partial}{\partial w}\left(g\,\frac{Q}{q}\right)\\
&amp;=\frac{1}{N}\frac{\partial}{\partial w}\left(g\,Q\right)
-g\,\frac{\partial q}{\partial w}.
\end{split}\end{equation}</annotation></semantics></math> Substituting
this into and cancelling terms gives
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>∂</mi><mi>q</mi></mrow><mrow><mi>∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>G</mi><mo>−</mo><mi>g</mi><mspace width="0.167em"></mspace><mfrac><mrow><mi>∂</mi><mi>q</mi></mrow><mrow><mi>∂</mi><mi>w</mi></mrow></mfrac><mo>−</mo><mi>r</mi><mspace width="0.167em"></mspace><mi>q</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\frac{\partial q}{\partial t}=G-g\,\frac{\partial q}{\partial w}-r\, q.
\label{wg}
\end{equation}</annotation></semantics></math> At this point we feel a
bit stupid when we realise that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>∂</mi><mi>q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>∂</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mfrac><mrow><mi>∂</mi><mi>q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>∂</mi><mi>w</mi></mrow></mfrac><mfrac><mrow><mi>d</mi><mi>w</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\begin{equation}
\frac{dq(w,t)}{dt}=\frac{\partial q(w,t)}{\partial t}+
\frac{\partial q(w,t)}{\partial w}\frac{dw}{dt}
\end{equation}</annotation></semantics></math> and that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>w</mi><mi>/</mi><mi>d</mi><mi>t</mi><mo>=</mo><mi>g</mi></mrow><annotation encoding="application/x-tex">dw/dt = g</annotation></semantics></math>,
so that reduces to
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>q</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>G</mi><mo>−</mo><mi>r</mi><mspace width="0.167em"></mspace><mi>q</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}\label{dqdt}
\frac{dq}{dt}=G-r\,q,
\end{equation}</annotation></semantics></math> which is what we could
have written down immediately, given our definition of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>.
So this equation would have been a good starting point for deriving the
PDE .</p>
<p>All the above equations are species specific. So in particular there
is one gonadic mass function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">q_i(w,t)</annotation></semantics></math>
for each species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and we will need to specify one rate function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">r_i(w,t)</annotation></semantics></math>
for each species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.</p>
<p>We need to specify the mass-specific release rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">r(w,t)</annotation></semantics></math>.
This then determines the total reproduction rate
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>ϵ</mi><mrow><mn>2</mn><msub><mi>w</mi><mn>0</mn></msub></mrow></mfrac><mo>∫</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>w</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
R_p(t)=\frac{\epsilon}{2w_0}\int N(w,t)q(w,t)r(w,t)dw.
\end{equation}</annotation></semantics></math> It will be difficult to
know how to choose the mass-specific rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">r(w,t)</annotation></semantics></math>
to produce the observed egg production rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">R_p(t)</annotation></semantics></math>.
We’ll probably have to do this by trial and error initially. The rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">r(w,t)</annotation></semantics></math>
should become large at least once a year so that the gonadic mass goes
back to close to zero. One possibility would be to make
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo>,</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">r(w,t)</annotation></semantics></math>
independent of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="numerical-implementation">Numerical implementation<a class="anchor" aria-label="anchor" href="#numerical-implementation"></a>
</h2>
<p>To solve the PDE we use the same upwind-difference scheme used by
mizer to solve the PDE . Let us therefore recall the details of that
scheme.</p>
<p>We discretise as follows:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msubsup><mi>N</mi><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>−</mo><msubsup><mi>N</mi><mi>w</mi><mi>t</mi></msubsup></mrow><mrow><mi>Δ</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>−</mi><mfrac><mrow><msubsup><mi>g</mi><mi>w</mi><mi>t</mi></msubsup><msubsup><mi>N</mi><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>−</mo><msubsup><mi>g</mi><mrow><mi>w</mi><mo>−</mo><mn>1</mn></mrow><mi>t</mi></msubsup><msubsup><mi>N</mi><mrow><mi>w</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mi>Δ</mi><mi>w</mi></mrow></mfrac><mo>−</mo><msubsup><mi>μ</mi><mi>w</mi><mi>t</mi></msubsup><mspace width="0.167em"></mspace><msubsup><mi>N</mi><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}\label{nd}
    \frac{N_w^{t+1}-N_w^t}{\Delta t}=-\frac{g_w^tN_w^{t+1}-g_{w-1}^tN_{w-1}^{t+1}}{\Delta w}-\mu_w^t\,N_w^{t+1}.
\end{equation}</annotation></semantics></math> Here we use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
to denote the integer indices of the discretised weight and discretised
time respectively. Multiplying by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Delta t</annotation></semantics></math>
and collecting terms gives
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>N</mi><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msubsup><mi>g</mi><mi>w</mi><mi>t</mi></msubsup><mfrac><mrow><mi>Δ</mi><mi>t</mi></mrow><mrow><mi>Δ</mi><mi>w</mi></mrow></mfrac><mo>+</mo><msubsup><mi>μ</mi><mi>w</mi><mi>t</mi></msubsup><mspace width="0.167em"></mspace><mi>Δ</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mi>N</mi><mrow><mi>w</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>g</mi><mrow><mi>w</mi><mo>−</mo><mn>1</mn></mrow><mi>t</mi></msubsup><mfrac><mrow><mi>Δ</mi><mi>t</mi></mrow><mrow><mi>Δ</mi><mi>w</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>N</mi><mi>w</mi><mi>t</mi></msubsup><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}\label{ndc}
    N_w^{t+1}\left(1+g_w^t\frac{\Delta t}{\Delta w}+\mu_w^t\,\Delta t\right)=
    N_{w-1}^{t+1}\left(g_{w-1}^t\frac{\Delta t}{\Delta w}\right)
    +N_w^t.
\end{equation}</annotation></semantics></math> Solving for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>N</mi><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">N_w^{t+1}</annotation></semantics></math>
gives
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>N</mi><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>=</mo><mfrac><mrow><msubsup><mi>S</mi><mi>w</mi><mi>t</mi></msubsup><mo>−</mo><msubsup><mi>A</mi><mi>w</mi><mi>t</mi></msubsup><msubsup><mi>N</mi><mrow><mi>w</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow><msubsup><mi>B</mi><mi>w</mi><mi>t</mi></msubsup></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}\label{nds}
    N_w^{t+1}=\frac{S_w^t-A_w^tN_{w-1}^{t+1}}{B_w^t},
\end{equation}</annotation></semantics></math> where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>A</mi><mi>w</mi><mi>t</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>−</mi><msubsup><mi>g</mi><mrow><mi>w</mi><mo>−</mo><mn>1</mn></mrow><mi>t</mi></msubsup><mfrac><mrow><mi>Δ</mi><mi>t</mi></mrow><mrow><mi>Δ</mi><mi>w</mi></mrow></mfrac><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>B</mi><mi>w</mi><mi>t</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>+</mo><msubsup><mi>g</mi><mi>w</mi><mi>t</mi></msubsup><mfrac><mrow><mi>Δ</mi><mi>t</mi></mrow><mrow><mi>Δ</mi><mi>w</mi></mrow></mfrac><mo>+</mo><msubsup><mi>μ</mi><mi>w</mi><mi>t</mi></msubsup><mspace width="0.167em"></mspace><mi>Δ</mi><mi>t</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>S</mi><mi>w</mi><mi>t</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>N</mi><mi>w</mi><mi>t</mi></msubsup><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}\label{ABS}
\begin{split}
   A_w^t&amp;=-g_{w-1}^t\frac{\Delta t}{\Delta w},\\
   B_w^t&amp;=1+g_w^t\frac{\Delta t}{\Delta w}+\mu^t_w\,\Delta t,\\
   S_w^t&amp;=N_w^t.
\end{split}
\end{equation}</annotation></semantics></math> Given an initial value
and a boundary condition encoding the influx of new-born individuals to
the smallest size class, The recurrence relation allows mizer to
calculate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>N</mi><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">N_w^{t+1}</annotation></semantics></math>
for all size classes at all later times.</p>
<p>Now we use the same scheme for the gonadic dynamics. So we discretise
as follows:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msubsup><mi>q</mi><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>−</mo><msubsup><mi>q</mi><mi>w</mi><mi>t</mi></msubsup></mrow><mrow><mi>Δ</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>−</mi><msubsup><mi>g</mi><mi>w</mi><mi>t</mi></msubsup><mfrac><mrow><msubsup><mi>q</mi><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>−</mo><msubsup><mi>q</mi><mrow><mi>w</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mi>Δ</mi><mi>w</mi></mrow></mfrac><mo>−</mo><msubsup><mi>r</mi><mi>w</mi><mi>t</mi></msubsup><mspace width="0.167em"></mspace><msubsup><mi>q</mi><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>+</mo><msubsup><mi>G</mi><mi>w</mi><mi>t</mi></msubsup><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
    \frac{q_w^{t+1}-q_w^t}{\Delta t}=-g_w^t\frac{q_w^{t+1}-q_{w-1}^{t+1}}{\Delta w}-r_w^t\,q_w^{t+1}+G_w^t.
\end{equation}</annotation></semantics></math> Note how close this
equation for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>
is to equation for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>.
Multiplying by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">\Delta t</annotation></semantics></math>
and collecting terms gives
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>q</mi><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msubsup><mi>g</mi><mi>w</mi><mi>t</mi></msubsup><mfrac><mrow><mi>Δ</mi><mi>t</mi></mrow><mrow><mi>Δ</mi><mi>w</mi></mrow></mfrac><mo>+</mo><msubsup><mi>r</mi><mi>w</mi><mi>t</mi></msubsup><mspace width="0.167em"></mspace><mi>Δ</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mi>q</mi><mrow><mi>w</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>g</mi><mi>w</mi><mi>t</mi></msubsup><mfrac><mrow><mi>Δ</mi><mi>t</mi></mrow><mrow><mi>Δ</mi><mi>w</mi></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>q</mi><mi>w</mi><mi>t</mi></msubsup><mo>+</mo><msubsup><mi>G</mi><mi>w</mi><mi>t</mi></msubsup><mspace width="0.167em"></mspace><mi>Δ</mi><mi>t</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
    q_w^{t+1}\left(1+g_w^t\frac{\Delta t}{\Delta w}+r_w^t\,\Delta t\right)=
    q_{w-1}^{t+1}\left(g_w^t\frac{\Delta t}{\Delta w}\right)
    +q_w^t+G_w^t\,\Delta t.
\end{equation}</annotation></semantics></math> Solving for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>q</mi><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">q_w^{t+1}</annotation></semantics></math>
gives
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>q</mi><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>=</mo><mfrac><mrow><msubsup><mi>s</mi><mi>w</mi><mi>t</mi></msubsup><mo>−</mo><msubsup><mi>a</mi><mi>w</mi><mi>t</mi></msubsup><msubsup><mi>q</mi><mrow><mi>w</mi><mo>−</mo><mn>1</mn></mrow><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow><msubsup><mi>b</mi><mi>w</mi><mi>t</mi></msubsup></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}\label{qds}
    q_w^{t+1}=\frac{s_w^t-a_w^tq_{w-1}^{t+1}}{b_w^t},
\end{equation}</annotation></semantics></math> where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>a</mi><mi>w</mi><mi>t</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>−</mi><msubsup><mi>g</mi><mi>w</mi><mi>t</mi></msubsup><mfrac><mrow><mi>Δ</mi><mi>t</mi></mrow><mrow><mi>Δ</mi><mi>w</mi></mrow></mfrac><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>b</mi><mi>w</mi><mi>t</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>+</mo><msubsup><mi>g</mi><mi>w</mi><mi>t</mi></msubsup><mfrac><mrow><mi>Δ</mi><mi>t</mi></mrow><mrow><mi>Δ</mi><mi>w</mi></mrow></mfrac><mo>+</mo><msubsup><mi>r</mi><mi>w</mi><mi>t</mi></msubsup><mspace width="0.167em"></mspace><mi>Δ</mi><mi>t</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>s</mi><mi>w</mi><mi>t</mi></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msubsup><mi>q</mi><mi>w</mi><mi>t</mi></msubsup><mo>+</mo><msubsup><mi>G</mi><mi>w</mi><mi>t</mi></msubsup><mspace width="0.167em"></mspace><mi>Δ</mi><mi>t</mi><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}\label{abs}
\begin{split}
   a_w^t&amp;=-g_w^t\frac{\Delta t}{\Delta w},\\
   b_w^t&amp;=1+g_w^t\frac{\Delta t}{\Delta w}+r_w^t\,\Delta t,\\
   s_w^t&amp;=q_w^t+G_w^t\,\Delta t.
\end{split}
\end{equation}</annotation></semantics></math> Together with an initial
value and the boundary condition that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>q</mi><mn>1</mn><mi>t</mi></msubsup><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">q_1^t=0</annotation></semantics></math>
at all times because the smallest individuals do not yet have any
gonadic mass, this recurrence relation allows us to calculate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>q</mi><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">q_w^{t+1}</annotation></semantics></math>
for all size classes at all later times.</p>
<p>Note how small the difference is between the discretised equation for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>
and the equation for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>.
The only difference lies in replacing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>A</mi><mi>w</mi><mi>t</mi></msubsup><mo>,</mo><msubsup><mi>B</mi><mi>w</mi><mi>t</mi></msubsup></mrow><annotation encoding="application/x-tex">A_w^t, B_w^t</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>S</mi><mi>w</mi><mi>t</mi></msubsup><annotation encoding="application/x-tex">S_w^t</annotation></semantics></math>
given in by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>a</mi><mi>w</mi><mi>t</mi></msubsup><mo>,</mo><msubsup><mi>b</mi><mi>w</mi><mi>t</mi></msubsup></mrow><annotation encoding="application/x-tex">a_w^t, b_w^t</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>s</mi><mi>w</mi><mi>t</mi></msubsup><annotation encoding="application/x-tex">s_w^t</annotation></semantics></math>
given in .</p>
</div>
<div class="section level2">
<h2 id="open-problems">Open problems<a class="anchor" aria-label="anchor" href="#open-problems"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Once we are modelling cohorts in mizer, the diffusion terms in
the size-spectrum dynamics will become important, because they will lead
to the broadening of the cohorts.</p></li>
<li><p>We do not yet know what the required step sizes are in size and
in time to faithfully reproduce the dynamics. Too large size steps will
lead to too much numerical diffusion. Too large time steps may lead to
numerical instability.</p></li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gustav Delius, Michael A. Spence.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
